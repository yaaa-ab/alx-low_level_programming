more functions and nestetd loops
